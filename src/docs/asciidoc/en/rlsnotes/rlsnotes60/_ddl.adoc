[#rnfb60-ddl]
= Data Definition Language (DDL)

[discrete#rnfb60-ddl-links]
== Quick Links

* <<rnfb60-ddl-drop-if-exists>>
* <<rnfb60-ddl-alter-func-det>>
* <<rnfb60-ddl-alter-sql-sec>>
* <<rnfb60-ddl-createdb-owner>>
// TODO: add links to sub-sections: <<rnfb60-ddl-id>>

////
Generic template:

[#rnfb60-ddl-<abbreviated-subject>]
== <subject>
<implementer/author>

Tracker ticket: https://github.com/FirebirdSQL/firebird/[pull/]<issue>[#<issue>]

<short description>

.Syntax
[listing]
----
<syntax>
----

[<more details>]

.Examples
[listing]
----
<examples>
----

////

[#rnfb60-ddl-drop-if-exists]
== `DROP ... [IF EXISTS]`
Adriano dos Santos Fernandes

Tracker ticket: https://github.com/FirebirdSQL/firebird/issues/4203[#4203]

Using subclause `IF EXISTS`, it's now possible to try to drop objects and not get errors when they did not exist.

.Supported statements
[listing,subs=+quotes]
----
DROP EXCEPTION [IF EXISTS] _exception_
DROP INDEX [IF EXISTS] _index-
DROP PROCEDURE [IF EXISTS] _procedure_
DROP TABLE [IF EXISTS] _table_
DROP TRIGGER [IF EXISTS] _trigger_
DROP VIEW [IF EXISTS] _view_
DROP FILTER [IF EXISTS] _filter_
DROP DOMAIN [IF EXISTS] _domain_
DROP [EXTERNAL] FUNCTION [IF EXISTS] _function_
DROP SHADOW [IF EXISTS] _shadow_
DROP ROLE [IF EXISTS] _role_
DROP GENERATOR [IF EXISTS] _generator_
DROP SEQUENCE [IF EXISTS] _sequence_
DROP COLLATION [IF EXISTS] _collation_
DROP USER [IF EXISTS] _user_ [USING PLUGIN _plugin_]
DROP PACKAGE [IF EXISTS] _package_
DROP PACKAGE BODY [IF EXISTS] _package_
DROP [GLOBAL] MAPPING [IF EXISTS] _mapping_
DROP SCHEMA [IF EXISTS] _schema_
ALTER TABLE _table_ DROP [COLUMN] [IF EXISTS] _column_
ALTER TABLE _table_ DROP CONSTRAINT [IF EXISTS] <constraint>
----

For `ALTER TABLE ... DROP` subclauses, DDL triggers are not fired if there are only `DROP ... IF EXISTS` subclauses and none of the columns and constraints existed.

For `DROP` statements with `IF EXISTS`, DDL triggers are not fired when the object did not exist.

[#rnfb60-ddl-alter-func-det]
== Alter `DETERMINISTIC` State of Functions
Alexander Zhdanov

Tracker ticket: https://github.com/FirebirdSQL/firebird/7427[#7427]

Added the ability to set or clear the deterministic state of a function without specifying the entire body.

.Syntax
[listing]
----
ALTER FUNCTION <name> <alter-function-option>...

<alter-function-option> ::=
    [NOT] DETERMINISTIC
  | <sql-security-option>
----

The SQL security options are covered in <<rnfb60-ddl-alter-sql-sec>>.

[#rnfb60-ddl-alter-sql-sec]
== Alter `SQL SECURITY` State of Functions, Procedures, and Packages
Alexander Zhdanov

Tracker ticket: https://github.com/FirebirdSQL/firebird/issues/7744[#7744]

Added the ability to alter the SQL security state of a function, procedure, or package without specifying the entire body.

.Syntax
[listing]
----
ALTER PROCEDURE <name> <sql-security-option>

ALTER PACKAGE <name> <sql-security-option>

ALTER FUNCTION <name> <alter-function-option>...

<sql-security-option> ::=
    SQL SECURITY {INVOKER | DEFINER}
  | DROP SQL SECURITY

<alter-function-option> ::=
    [NOT] DETERMINISTIC
  | <sql-security-option>
----

Dropping the SQL security state will apply the SQL security configuration of the schema.

Although the syntax of `ALTER FUNCTION` allows specifying multiple conflicting SQL security options, doing so will raise an error ("`__duplicate specification of SQL SECURITY - not supported__`").

The `[NOT] DETERMINISTIC` option for `ALTER FUNCTION` is covered in <<rnfb60-ddl-alter-func-det>>.

[#rnfb60-ddl-createdb-owner]
== Create Database With a Different Owner
Dimitry Sibiryakov

Tracker ticket: https://github.com/FirebirdSQL/firebird/issues/7719[#7719]

The `CREATE DATABASE` statement now accepts an `OWNER` clause to set a different user than the creator as the owner.
Only users with administrator privileges can use the `OWNER` clause.

.Syntax
[listing]
----
CREATE DATABASE <filespec>
  [ <db_initial_option>... ]
  [ <db_config_option>... ]

<db_initial_option> ::=
    !! existing options !!
  | OWNER _owner_
----
